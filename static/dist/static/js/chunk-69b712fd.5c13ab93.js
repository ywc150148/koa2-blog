(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69b712fd"],{"00b9":function(t,e,n){"use strict";var i=n("229e"),a=n.n(i);a.a},"04c5":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tweet-write"},[n("van-nav-bar",{attrs:{"left-arrow":"",fixed:"",border:!1},on:{"click-left":t.onClickLeft,"click-right":t.onClickRight}},[n("van-button",{attrs:{slot:"right",type:"primary",size:"small"},slot:"right"},[t._v("发送")])],1),n("div",{staticClass:"tweet-write-wrap"},[n("van-cell-group",[n("van-field",{attrs:{rows:"4",border:!1,type:"textarea",maxlength:"300","show-word-limit":"",placeholder:"请输入你想说的..."},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),n("div",{staticClass:"tweet-write-uploader"},[n("van-uploader",{attrs:{multiple:"","max-count":9,"preview-size":"120","after-read":t.onAfterRead},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)],1)],1)},a=[],o=(n("96cf"),n("3b8d")),r=(n("6b54"),n("ac6a"),n("a481"),n("e17f"),n("2241")),s=n("bd86"),c=(n("e930"),n("8f80")),l=(n("7f7f"),n("5246"),n("6b41")),u=n("6f45"),f=n.n(u),h=n("74c2");function d(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return new Promise((function(o,r){try{var s=function(e){var n=new Image;n.src=e,n.onload=function(){t.getData(n,(function(){l=t.getTag(this,"Orientation")})),c(n)}},c=function(t){u=u||t.width;var e=document.createElement("canvas"),n=e.getContext("2d"),i=t.width/t.height,a=u/i,r=0,s=0;if(e.width=u,e.height=a,l>1)switch(r=-u/2,s=-a/2,l){case 3:e.width=u,e.height=a,n.translate(u/2,a/2),n.rotate(Math.PI);break;case 6:e.width=a,e.height=u,n.translate(a/2,u/2),n.rotate(Math.PI/2);break;case 8:e.width=a,e.height=u,n.translate(a/2,u/2),n.rotate(1.5*Math.PI);break}n.fillStyle="#fff",n.drawImage(t,r,s,u,a);var c=e.toDataURL("image/jpeg",1);o({code:0,mag:"ok",base64:c})};t||r({code:1,msg:"需要引入依赖：exif-js.js"});var l,u=i;if(/^data:image\/(\w+);base64,/i.test(e))"gif"==a(n.result)&&o({code:0,msg:"gif",base64:n.result}),s(e);else if(e.type&&/^image/.test(e.type)){var f=new FileReader;f.readAsDataURL(e),f.onloadend=function(){"gif"==a(this.result)&&o({code:0,msg:"gif",base64:this.result}),s(this.result)}}else r({code:1,msg:"传入的参数不符"})}catch(h){t||r({code:1,msg:"出错",err:h})}}));function a(t){var e=/^data:image\/(\w+);base64,/i,n=e.exec(t);return null!==n?n[1]:n}}var g,p=d,m={name:"",components:(g={},Object(s["a"])(g,l["a"].name,l["a"]),Object(s["a"])(g,c["a"].name,c["a"]),g),data:function(){return{content:"",fileList:[],unSend:!0,pathArray:[]}},computed:{},created:function(){},mounted:function(){console.log('this.$tools.getStorage("tweetDraft")',this.$tools.getStorage("tweetDraft"));var t=this.$tools.getStorage("tweetDraft");null!==t&&(this.content=t.content,this.fileList=t.fileList)},beforeDestroy:function(){},methods:{onClickLeft:function(){var t=this,e=""!=this.content||this.fileList.length>0;!0===this.unSend&&!0===e?(console.log("1"),r["a"].confirm({title:"是否保存草稿？"}).then((function(){t.$tools.setStorage("tweetDraft",{content:t.content,fileList:t.fileList}),t.$router.replace("/tweet")})).catch((function(){t.$tools.removeStorage("tweetDraft"),t.$router.replace("/tweet")}))):this.$router.replace("/tweet")},onClickRight:function(){var t=this;if(""==this.content)return this.$toast("请输入你想说的...");if(this.fileList.length>0){var e=new Array;this.fileList.forEach((function(t,n){e.push(t.content)})),console.log("imgarr",e);var n=this.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",content:"上传图片..."});this.$axios.post(RESTFULAPI.public.uploadImg,{type:"tweet",base64Array:e}).then((function(e){n.clear(),t.pathArray=e.data.data.pathArray,("[object Array]"!==Object.prototype.toString.call(t.pathArray)||t.pathArray.length<1)&&(t.pathArray=[]),t.postTweet(t.content,t.pathArray)})).catch((function(e){n.clear(),t.$toast(e.data.msg)}))}else this.postTweet(this.content)},postTweet:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.$axios.post(RESTFULAPI.public.tweetPost,{content:t,images:n}).then((function(t){e.unSend=!1,e.$toast(t.data.msg),e.$tools.removeStorage("tweetDraft"),e.pushHref("/tweet")})).catch((function(t){e.$toast(t.data.msg)}))},onAfterRead:function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(e){var n,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.fileList.length-1,t.next=3,p(f.a,e.file).then((function(t){i.fileList[n].content=t.base64})).catch((function(t){i.$toast(t.msg)}));case 3:return Object(h["a"])(this.fileList[n].content).then((function(t){i.fileList[n].content=t.base64})).catch((function(t){i.$toast(t.msg)})),t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},v=m,b=(n("00b9"),n("2877")),w=Object(b["a"])(v,i,a,!1,null,"a5e62b58",null);e["default"]=w.exports},2241:function(t,e,n){"use strict";var i,a=n("c31d"),o=n("2b0e"),r=n("d282"),s=n("b1d2"),c=n("6605"),l=n("022e"),u=n("b650"),f=Object(r["a"])("dialog"),h=f[0],d=f[1],g=f[2],p=h({mixins:[c["a"],l["a"]],props:{title:String,message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(t){var e=this;this.$emit(t),this.beforeClose?(this.loading[t]=!0,this.beforeClose(t,(function(n){!1!==n&&e.loading[t]&&e.onClose(t),e.loading.confirm=!1,e.loading.cancel=!1}))):this.onClose(t)},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){this.$emit("opened")},onClosed:function(){this.$emit("closed")}},render:function(){var t,e,n=this,i=arguments[0];if(this.shouldRender){var a=this.message,o=this.messageAlign,r=this.slots(),c=this.slots("title")||this.title,l=c&&i("div",{class:d("header",{isolated:!a&&!r})},[c]),f=(r||a)&&i("div",{class:d("content")},[r||i("div",{domProps:{innerHTML:a},class:d("message",(t={"has-title":c},t[o]=o,t))})]),h=this.showCancelButton&&this.showConfirmButton,p=i("div",{class:[s["e"],d("footer",{buttons:h})]},[this.showCancelButton&&i(u["a"],{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||g("cancel")},class:d("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){n.handleAction("cancel")}}}),this.showConfirmButton&&i(u["a"],{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||g("confirm")},class:[d("confirm"),(e={},e[s["c"]]=h,e)],style:{color:this.confirmButtonColor},on:{click:function(){n.handleAction("confirm")}}})]);return i("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[i("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||a},class:[d(),this.className]},[l,f,p])])}}}),m=n("a142");function v(t){return document.body.contains(t)}function b(){i&&i.$destroy(),i=new(o["a"].extend(p))({el:document.createElement("div"),propsData:{lazyRender:!1}}),i.$on("input",(function(t){i.value=t}))}function w(t){return m["d"]?Promise.resolve():new Promise((function(e,n){i&&v(i.$el)||b(),Object(a["a"])(i,w.currentOptions,t,{resolve:e,reject:n})}))}w.defaultOptions={value:!0,title:"",message:"",overlay:!0,className:"",lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!1,closeOnClickOverlay:!1,callback:function(t){i["confirm"===t?"resolve":"reject"](t)}},w.alert=w,w.confirm=function(t){return w(Object(a["a"])({showCancelButton:!0},t))},w.close=function(){i&&(i.value=!1)},w.setDefaultOptions=function(t){Object(a["a"])(w.currentOptions,t)},w.resetDefaultOptions=function(){w.currentOptions=Object(a["a"])({},w.defaultOptions)},w.resetDefaultOptions(),w.install=function(){o["a"].use(p)},w.Component=p,o["a"].prototype.$dialog=w;e["a"]=w},"229e":function(t,e,n){},"2fcb":function(t,e,n){},4917:function(t,e,n){"use strict";var i=n("cb7c"),a=n("9def"),o=n("0390"),r=n("5f1b");n("214f")("match",1,(function(t,e,n,s){return[function(n){var i=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,i):new RegExp(n)[e](String(i))},function(t){var e=s(n,t,this);if(e.done)return e.value;var c=i(t),l=String(this);if(!c.global)return r(c,l);var u=c.unicode;c.lastIndex=0;var f,h=[],d=0;while(null!==(f=r(c,l))){var g=String(f[0]);h[d]=g,""===g&&(c.lastIndex=o(l,a(c.lastIndex),u)),d++}return 0===d?null:h}]}))},5246:function(t,e,n){"use strict";n("68ef"),n("09fe"),n("8a0b")},"5dbc":function(t,e,n){var i=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var o,r=e.constructor;return r!==n&&"function"==typeof r&&(o=r.prototype)!==n.prototype&&i(o)&&a&&a(t,o),t}},"5df2":function(t,e,n){var i=n("5ca1"),a=n("d752");i(i.S+i.F*(Number.parseFloat!=a),"Number",{parseFloat:a})},"6b41":function(t,e,n){"use strict";var i=n("2638"),a=n.n(i),o=n("d282"),r=n("a142"),s=n("ba31"),c=n("b1d2"),l=n("ad06"),u=Object(o["a"])("nav-bar"),f=u[0],h=u[1];function d(t,e,n,i){var o;return t("div",a()([{class:[h({fixed:e.fixed}),(o={},o[c["b"]]=e.border,o)],style:{zIndex:e.zIndex}},Object(s["b"])(i)]),[t("div",{class:h("left"),on:{click:i.listeners["click-left"]||r["e"]}},[n.left?n.left():[e.leftArrow&&t(l["a"],{class:h("arrow"),attrs:{name:"arrow-left"}}),e.leftText&&t("span",{class:h("text")},[e.leftText])]]),t("div",{class:[h("title"),"van-ellipsis"]},[n.title?n.title():e.title]),t("div",{class:h("right"),on:{click:i.listeners["click-right"]||r["e"]}},[n.right?n.right():e.rightText&&t("span",{class:h("text")},[e.rightText])])])}d.props={title:String,fixed:Boolean,leftText:String,rightText:String,leftArrow:Boolean,border:{type:Boolean,default:!0},zIndex:{type:Number,default:1}},e["a"]=f(d)},"74c2":function(t,e,n){"use strict";n("34ef"),n("4917"),n("28a5"),n("5df2"),n("c5f6"),n("fca0");function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((function(a,o){try{var r,s=e.quality?parseFloat(e.quality):.7,c=Number.isFinite(e.maxSize)?e.maxSize:1048576,l=e.width?e.width:"",u=e.height?e.height:"",f=new Image,h=i(t),d=e.ignoredArr||["gif"];if(null!==h&&d.indexOf(h)>=0){var g=n(t),p=g.size<c,m=Number.parseFloat((g.size/1024).toFixed(2)),v={code:p?0:1,msg:p?"ok":"图片过大",size:g.size,format:h,base64:t,KB:m};!p&&o(v)||a(v)}s=Number.isFinite(s)&&s>0&&s<1?s:.7,f.src=t,f.onload=function(){var t=this.width,e=this.height,i=t/e;t=l||(!l&&t>=1024?1024:t),e=u||t/i;var f=document.createElement("canvas"),d=f.getContext("2d"),g=document.createAttribute("width"),p=document.createAttribute("height");g.nodeValue=t,p.nodeValue=e,f.setAttributeNode(g),f.setAttributeNode(p),d.drawImage(this,0,0,t,e),r=f.toDataURL("image/".concat(h),s);var m=n(r),v=Number.parseFloat((m.size/1024).toFixed(2)),b=m.size<c,w={code:b?0:1,msg:b?"ok":"图片过大",size:m.size,format:h,base64:r,KB:v};!b&&o(w)||a(w)}}catch(b){console.log("err",b),o({code:1,msg:"发生错误",err:b})}}));function n(t){var e=t.split(","),n=e[0].match(/:(.*?);/)[1],i=atob(e[1]),a=i.length,o=new Uint8Array(a);while(a--)o[a]=i.charCodeAt(a);return new Blob([o],{type:n})}function i(t){var e=/^data:image\/(\w+);base64,/i,n=e.exec(t);return null!==n?n[1]:n}}e["a"]=i},"8a0b":function(t,e,n){},"8b97":function(t,e,n){var i=n("d3f4"),a=n("cb7c"),o=function(t,e){if(a(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:o}},aa77:function(t,e,n){var i=n("5ca1"),a=n("be13"),o=n("79e5"),r=n("fdef"),s="["+r+"]",c="​",l=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),f=function(t,e,n){var a={},s=o((function(){return!!r[t]()||c[t]()!=c})),l=a[t]=s?e(h):r[t];n&&(a[n]=l),i(i.P+i.F*s,"String",a)},h=f.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},c5f6:function(t,e,n){"use strict";var i=n("7726"),a=n("69a8"),o=n("2d95"),r=n("5dbc"),s=n("6a99"),c=n("79e5"),l=n("9093").f,u=n("11e9").f,f=n("86cc").f,h=n("aa77").trim,d="Number",g=i[d],p=g,m=g.prototype,v=o(n("2aeb")(m))==d,b="trim"in String.prototype,w=function(t){var e=s(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():h(e,3);var n,i,a,o=e.charCodeAt(0);if(43===o||45===o){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+e}for(var r,c=e.slice(2),l=0,u=c.length;l<u;l++)if(r=c.charCodeAt(l),r<48||r>a)return NaN;return parseInt(c,i)}}return+e};if(!g(" 0o1")||!g("0b1")||g("+0x1")){g=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof g&&(v?c((function(){m.valueOf.call(n)})):o(n)!=d)?r(new p(w(e)),n,g):w(e)};for(var y,x=n("9e1e")?l(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),A=0;x.length>A;A++)a(p,y=x[A])&&!a(g,y)&&f(g,y,u(p,y));g.prototype=m,m.constructor=g,n("2aba")(i,d,g)}},d752:function(t,e,n){var i=n("7726").parseFloat,a=n("aa77").trim;t.exports=1/i(n("fdef")+"-0")!==-1/0?function(t){var e=a(String(t),3),n=i(e);return 0===n&&"-"==e.charAt(0)?-0:n}:i},e17f:function(t,e,n){"use strict";n("68ef"),n("4d75"),n("09fe"),n("2fcb")},fca0:function(t,e,n){var i=n("5ca1"),a=n("7726").isFinite;i(i.S,"Number",{isFinite:function(t){return"number"==typeof t&&a(t)}})},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-69b712fd.5c13ab93.js.map