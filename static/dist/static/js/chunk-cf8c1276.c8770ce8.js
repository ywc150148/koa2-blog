(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cf8c1276"],{1272:function(t,e,n){"use strict";var o=n("2aa7"),a=n.n(o);a.a},2241:function(t,e,n){"use strict";var o,a=n("c31d"),s=n("2b0e"),i=n("d282"),r=n("b1d2"),c=n("6605"),l=n("022e"),u=n("b650"),f=Object(i["a"])("dialog"),d=f[0],h=f[1],p=f[2],m=d({mixins:[c["a"],l["a"]],props:{title:String,message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(t){var e=this;this.$emit(t),this.beforeClose?(this.loading[t]=!0,this.beforeClose(t,(function(n){!1!==n&&e.loading[t]&&e.onClose(t),e.loading.confirm=!1,e.loading.cancel=!1}))):this.onClose(t)},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){this.$emit("opened")},onClosed:function(){this.$emit("closed")}},render:function(){var t,e,n=this,o=arguments[0];if(this.shouldRender){var a=this.message,s=this.messageAlign,i=this.slots(),c=this.slots("title")||this.title,l=c&&o("div",{class:h("header",{isolated:!a&&!i})},[c]),f=(i||a)&&o("div",{class:h("content")},[i||o("div",{domProps:{innerHTML:a},class:h("message",(t={"has-title":c},t[s]=s,t))})]),d=this.showCancelButton&&this.showConfirmButton,m=o("div",{class:[r["e"],h("footer",{buttons:d})]},[this.showCancelButton&&o(u["a"],{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||p("cancel")},class:h("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){n.handleAction("cancel")}}}),this.showConfirmButton&&o(u["a"],{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||p("confirm")},class:[h("confirm"),(e={},e[r["c"]]=d,e)],style:{color:this.confirmButtonColor},on:{click:function(){n.handleAction("confirm")}}})]);return o("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[o("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||a},class:[h(),this.className]},[l,f,m])])}}}),g=n("a142");function v(t){return document.body.contains(t)}function w(){o&&o.$destroy(),o=new(s["a"].extend(m))({el:document.createElement("div"),propsData:{lazyRender:!1}}),o.$on("input",(function(t){o.value=t}))}function b(t){return g["d"]?Promise.resolve():new Promise((function(e,n){o&&v(o.$el)||w(),Object(a["a"])(o,b.currentOptions,t,{resolve:e,reject:n})}))}b.defaultOptions={value:!0,title:"",message:"",overlay:!0,className:"",lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!1,closeOnClickOverlay:!1,callback:function(t){o["confirm"===t?"resolve":"reject"](t)}},b.alert=b,b.confirm=function(t){return b(Object(a["a"])({showCancelButton:!0},t))},b.close=function(){o&&(o.value=!1)},b.setDefaultOptions=function(t){Object(a["a"])(b.currentOptions,t)},b.resetDefaultOptions=function(){b.currentOptions=Object(a["a"])({},b.defaultOptions)},b.resetDefaultOptions(),b.install=function(){s["a"].use(m)},b.Component=m,s["a"].prototype.$dialog=b;e["a"]=b},"2aa7":function(t,e,n){},"2fcb":function(t,e,n){},4917:function(t,e,n){"use strict";var o=n("cb7c"),a=n("9def"),s=n("0390"),i=n("5f1b");n("214f")("match",1,(function(t,e,n,r){return[function(n){var o=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,o):new RegExp(n)[e](String(o))},function(t){var e=r(n,t,this);if(e.done)return e.value;var c=o(t),l=String(this);if(!c.global)return i(c,l);var u=c.unicode;c.lastIndex=0;var f,d=[],h=0;while(null!==(f=i(c,l))){var p=String(f[0]);d[h]=p,""===p&&(c.lastIndex=s(l,a(c.lastIndex),u)),h++}return 0===h?null:d}]}))},"57a0":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"user"},[n("div",{staticClass:"user-head"},[n("div",{staticClass:"user-head_row"},[n("div",{staticClass:"flex"},[n("van-image",{staticClass:"user-head_image",attrs:{round:"",fit:"cover","lazy-load":"",src:t.user.head_img},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[t._v("加载失败")]},proxy:!0}])}),t.showUpload?n("div",{staticClass:"user-head_row__r"},[n("van-button",{attrs:{round:"",type:"default",size:"small",color:"#666"},on:{click:t.onUnshowUpload}},[t._v("取消")]),n("van-button",{attrs:{round:"",type:"info",size:"small"},on:{click:t.handleUpload}},[t._v("完成")])],1):t._e()],1),n("p",{staticClass:"user-head_name van-ellipsis"},[t._v(t._s(t.user.nickname))]),n("van-uploader",{class:{"show-upload":t.showUpload},attrs:{"preview-image":"","max-count":1,"after-read":t.beforeRead},on:{delete:t.onUnshowUpload},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)]),n("div",{staticClass:"user-info"},[n("van-cell",[n("template",{slot:"title"},[n("span",{staticClass:"custom-title"},[t._v(t._s(t.user.name))])]),n("van-tag",{attrs:{slot:"right-icon",round:"",plain:"",type:"success"},on:{click:t.handleName},slot:"right-icon"},[t._v("账号")])],2),n("van-cell",[n("template",{slot:"title"},[n("span",{staticClass:"custom-title"},[t._v("密码")]),n("van-icon",{attrs:{name:"closed-eye"}})],1),n("van-tag",{attrs:{slot:"right-icon",type:"primary",round:""},on:{click:function(e){return t.handleChange(1)}},slot:"right-icon"},[t._v("密码")])],2),n("van-cell",[n("template",{slot:"title"},[n("span",{staticClass:"custom-title"},[t._v(t._s(t.user.nickname))])]),n("van-tag",{attrs:{slot:"right-icon",type:"primary",round:""},on:{click:function(e){return t.handleChange(0)}},slot:"right-icon"},[t._v("昵称")])],2),n("van-cell",[n("template",{slot:"title"},[n("span",{staticClass:"custom-title"},[t._v(t._s(t.sexs[t.user.sex]))])]),n("van-tag",{attrs:{slot:"right-icon",type:"primary",round:""},on:{click:t.handleChangeSex},slot:"right-icon"},[t._v("性别")])],2)],1),n("van-popup",{attrs:{position:"bottom"},model:{value:t.showPopup,callback:function(e){t.showPopup=e},expression:"showPopup"}},[n("van-picker",{attrs:{"show-toolbar":"",title:"修改性别",columns:t.sexs,"default-index":t.sex},on:{cancel:t.onSexCancel,confirm:t.onSexConfirm}})],1),n("van-dialog",{attrs:{title:t.titles[t.type],"show-cancel-button":"",beforeClose:t.onBeforeClose},on:{cancel:t.onCancel,confirm:t.onConfirm},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[n("div",{staticClass:"user-dialog"},[0===t.type?n("van-cell-group",[n("van-field",{staticClass:"van-hairline--surround",attrs:{maxlength:"12",clearable:"",placeholder:"请输入昵称","error-message":t.errormsg0},model:{value:t.newNickName,callback:function(e){t.newNickName="string"===typeof e?e.trim():e},expression:"newNickName"}})],1):t._e(),1===t.type?n("van-cell-group",[n("van-field",{staticClass:"van-hairline--surround",staticStyle:{"margin-bottom":"10px"},attrs:{type:"password",maxlength:"12",placeholder:"请输入原密码",required:"",clearable:"","error-message":t.errormsg1},model:{value:t.password,callback:function(e){t.password="string"===typeof e?e.trim():e},expression:"password"}})],1):t._e(),1===t.type?n("van-cell-group",[n("van-field",{staticClass:"van-hairline--surround",attrs:{type:"password",maxlength:"12",placeholder:"请输入新密码",required:"",clearable:"","error-message":t.errormsg2},model:{value:t.newpassword,callback:function(e){t.newpassword="string"===typeof e?e.trim():e},expression:"newpassword"}})],1):t._e()],1)])],1)},a=[],s=(n("8e6e"),n("ac6a"),n("456d"),n("96cf"),n("3b8d")),i=n("bd86"),r=(n("e17f"),n("2241")),c=(n("7f7f"),n("2f62")),l=n("74c2"),u=n("413c");function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(n,!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={name:"userManagement",components:Object(i["a"])({},r["a"].Component.name,r["a"].Component),data:function(){return{showUpload:!1,fileList:[],newHead_img:"",type:"",showDialog:!1,titles:["修改昵称","修改密码"],newNickName:"",password:"",newpassword:"",errormsg0:"",errormsg1:"",errormsg2:"",sexs:["隐藏","男","女"],sex:0,showPopup:!1}},computed:d({},Object(c["c"])(["isLogin","user"])),mounted:function(){this.sex=this.user.sex},methods:d({},Object(c["b"])(["setUser"]),{beforeRead:function(t){this.showUpload=!0},handleUpload:function(){var t=this;Object(l["a"])(this.fileList[0].content,{width:100}).then((function(e){t.uploadImg(e.base64)})).catch((function(e){t.$toast(e.msg),t.onUnshowUpload()}))},uploadImg:function(t){var e=this;this.$axios.post(RESTFULAPI.public.uploadImg,{type:"head",base64Array:[t]}).then((function(t){e.updataInfo({head_img:t.data.data.pathArray[0]},(function(){e.setUser({head_img:BASEURL+t.data.data.pathArray[0]}),e.onUnshowUpload()}))})).catch((function(t){}))},onUnshowUpload:function(){this.fileList.splice(0,1),this.showUpload=!1},handleChange:function(t){this.type=t,this.showDialog=!0,0===this.type&&(this.newNickName=this.user.nickname)},onCancel:function(){0===this.type&&(this.newNickName=this.user.nickname),1===this.type&&(this.password="",this.newpassword="")},onConfirm:function(){var t=this;0===this.type&&this.$tools.isRegNickName(this.newNickName)&&this.updataInfo({nickname:this.newNickName},(function(){t.setUser({nickname:t.newNickName})})),1===this.type&&this.password!=this.newpassword&&this.$tools.isRegPwd(this.newpassword)&&this.updataInfo({password:Object(u["a"])(this.password),newpassword:Object(u["a"])(this.newpassword)},(function(){t.password="",t.newpassword=""}))},onBeforeClose:function(t,e){if(0===this.type&&!this.$tools.isRegNickName(this.newNickName)&&"confirm"==t)return this.errormsg0="昵称是1-12个字符，只能包含中文、字母、数字、下划线",void e(!1);if(this.errormsg0="",1===this.type&&"confirm"==t){if(this.password.length<1)return this.errormsg1="原密码不能为空",void e(!1);if(this.errormsg1="",!this.$tools.isRegPwd(this.newpassword))return this.errormsg2="密码是6-12个字符，只能包含字母、数字、“_”、“-”、“@”",void e(!1);if(this.password==this.newpassword)return this.errormsg2="原密码与新密码不能相同",void e(!1)}this.errormsg2="",e()},handleChangeSex:function(){this.showPopup=!0},onSexCancel:function(t){this.showPopup=!1},onSexConfirm:function(t){var e=this;this.updataInfo({sex:this.sexs.indexOf(t)},(function(){e.setUser({sex:e.sexs.indexOf(t)}),e.showPopup=!1}))},handleName:function(){var t=Math.round(Math.random()),e=["账号是唯一的，不可以修改",this.user.name];this.$toast(e[t])},updataInfo:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,o,a=this,s=arguments;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:"",o=this.$toast.loading({duration:0,forbidClick:!0,loadingType:"spinner",message:"请求中..."}),t.next=4,this.$axios.put(RESTFULAPI.public.updateInfo,e).then((function(t){n&&n(),o.clear(),a.$toast(t.data.msg||"修改信息成功")})).catch((function(t){o.clear()}));case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()})},p=h,m=(n("1272"),n("2877")),g=Object(m["a"])(p,o,a,!1,null,"64775379",null);e["default"]=g.exports},"5dbc":function(t,e,n){var o=n("d3f4"),a=n("8b97").set;t.exports=function(t,e,n){var s,i=e.constructor;return i!==n&&"function"==typeof i&&(s=i.prototype)!==n.prototype&&o(s)&&a&&a(t,s),t}},"5df2":function(t,e,n){var o=n("5ca1"),a=n("d752");o(o.S+o.F*(Number.parseFloat!=a),"Number",{parseFloat:a})},"74c2":function(t,e,n){"use strict";n("34ef"),n("4917"),n("28a5"),n("5df2"),n("c5f6"),n("fca0");function o(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return new Promise((function(a,s){try{var i,r=e.quality?parseFloat(e.quality):.7,c=Number.isFinite(e.maxSize)?e.maxSize:1048576,l=e.width?e.width:"",u=e.height?e.height:"",f=new Image,d=o(t),h=e.ignoredArr||["gif"];if(null!==d&&h.indexOf(d)>=0){var p=n(t),m=p.size<c,g=Number.parseFloat((p.size/1024).toFixed(2)),v={code:m?0:1,msg:m?"ok":"图片过大",size:p.size,format:d,base64:t,KB:g};!m&&s(v)||a(v)}r=Number.isFinite(r)&&r>0&&r<1?r:.7,f.src=t,f.onload=function(){var t=this.width,e=this.height,o=t/e;t=l||(!l&&t>=1024?1024:t),e=u||t/o;var f=document.createElement("canvas"),h=f.getContext("2d"),p=document.createAttribute("width"),m=document.createAttribute("height");p.nodeValue=t,m.nodeValue=e,f.setAttributeNode(p),f.setAttributeNode(m),h.drawImage(this,0,0,t,e),i=f.toDataURL("image/".concat(d),r);var g=n(i),v=Number.parseFloat((g.size/1024).toFixed(2)),w=g.size<c,b={code:w?0:1,msg:w?"ok":"图片过大",size:g.size,format:d,base64:i,KB:v};!w&&s(b)||a(b)}}catch(w){console.log("err",w),s({code:1,msg:"发生错误",err:w})}}));function n(t){var e=t.split(","),n=e[0].match(/:(.*?);/)[1],o=atob(e[1]),a=o.length,s=new Uint8Array(a);while(a--)s[a]=o.charCodeAt(a);return new Blob([s],{type:n})}function o(t){var e=/^data:image\/(\w+);base64,/i,n=e.exec(t);return null!==n?n[1]:n}}e["a"]=o},"8b97":function(t,e,n){var o=n("d3f4"),a=n("cb7c"),s=function(t,e){if(a(t),!o(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,o){try{o=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),o(t,[]),e=!(t instanceof Array)}catch(a){e=!0}return function(t,n){return s(t,n),e?t.__proto__=n:o(t,n),t}}({},!1):void 0),check:s}},aa77:function(t,e,n){var o=n("5ca1"),a=n("be13"),s=n("79e5"),i=n("fdef"),r="["+i+"]",c="​",l=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),f=function(t,e,n){var a={},r=s((function(){return!!i[t]()||c[t]()!=c})),l=a[t]=r?e(d):i[t];n&&(a[n]=l),o(o.P+o.F*r,"String",a)},d=f.trim=function(t,e){return t=String(a(t)),1&e&&(t=t.replace(l,"")),2&e&&(t=t.replace(u,"")),t};t.exports=f},c5f6:function(t,e,n){"use strict";var o=n("7726"),a=n("69a8"),s=n("2d95"),i=n("5dbc"),r=n("6a99"),c=n("79e5"),l=n("9093").f,u=n("11e9").f,f=n("86cc").f,d=n("aa77").trim,h="Number",p=o[h],m=p,g=p.prototype,v=s(n("2aeb")(g))==h,w="trim"in String.prototype,b=function(t){var e=r(t,!1);if("string"==typeof e&&e.length>2){e=w?e.trim():d(e,3);var n,o,a,s=e.charCodeAt(0);if(43===s||45===s){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:o=2,a=49;break;case 79:case 111:o=8,a=55;break;default:return+e}for(var i,c=e.slice(2),l=0,u=c.length;l<u;l++)if(i=c.charCodeAt(l),i<48||i>a)return NaN;return parseInt(c,o)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(v?c((function(){g.valueOf.call(n)})):s(n)!=h)?i(new m(b(e)),n,p):b(e)};for(var y,C=n("9e1e")?l(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;C.length>x;x++)a(m,y=C[x])&&!a(p,y)&&f(p,y,u(m,y));p.prototype=g,g.constructor=p,n("2aba")(o,h,p)}},d752:function(t,e,n){var o=n("7726").parseFloat,a=n("aa77").trim;t.exports=1/o(n("fdef")+"-0")!==-1/0?function(t){var e=a(String(t),3),n=o(e);return 0===n&&"-"==e.charAt(0)?-0:n}:o},e17f:function(t,e,n){"use strict";n("68ef"),n("4d75"),n("09fe"),n("2fcb")},fca0:function(t,e,n){var o=n("5ca1"),a=n("7726").isFinite;o(o.S,"Number",{isFinite:function(t){return"number"==typeof t&&a(t)}})},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-cf8c1276.c8770ce8.js.map